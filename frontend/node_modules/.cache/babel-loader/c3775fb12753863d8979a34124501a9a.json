{"ast":null,"code":"import Cookies from \"js-cookie\";\nimport qs from 'qs';\nconst BASEAPI = 'http://localhost:5000'; // envaindo dados para o webservice via POST\n\nconst apiFetchPost = async (endpoint, body) => {\n  // verifica se não tem um token junto no body (corpo da mensagem), neste caso ele busca\n  // nos Cookies pelo token e agrega junto no body\n  if (!body.token) {\n    let token = Cookies.get('token');\n\n    if (token) {\n      body.token = token;\n    }\n  } // cria uma constante de comunicação com o webservice envaindo o endereço (BASEAPI) + a rota (endpoint)\n\n\n  const res = await fetch(BASEAPI + endpoint, {\n    method: 'POST',\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(body)\n  });\n  const json = await res.json();\n  console.log(\"###########\");\n  console.log(json);\n\n  if (json.notallowed) {\n    window.location.href = '/login';\n    return;\n  }\n\n  return json;\n};\n\nconst apiFetchGet = async (endpoint, body = []) => {\n  if (!body.token) {\n    let token = Cookies.get('token');\n\n    if (token) {\n      body.token = token;\n    }\n  }\n\n  const res = await fetch(`${BASEAPI + endpoint}?${qs.stringify(body)}`);\n  const json = await res.json();\n\n  if (json.notallowed) {\n    window.location.href = '/login';\n    return;\n  }\n\n  return json;\n};\n\nconst AmorinhaAPI = {\n  login: async (email, password) => {\n    const jason = await apiFetchPost('/user/login', {\n      email,\n      password\n    });\n    return jason;\n  },\n  signup: async (name, email, password) => {\n    const json = await apiFetchPost('/user/signup', {\n      name,\n      email,\n      password\n    });\n    return json;\n  }\n};\nexport default (() => AmorinhaAPI);","map":{"version":3,"sources":["/home/jael/Dropbox/devinhouse/front/react/amorinha/frontend/src/helpers/AmorinhaAPI.js"],"names":["Cookies","qs","BASEAPI","apiFetchPost","endpoint","body","token","get","res","fetch","method","headers","JSON","stringify","json","console","log","notallowed","window","location","href","apiFetchGet","AmorinhaAPI","login","email","password","jason","signup","name"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,WAApB;AACA,OAAOC,EAAP,MAAe,IAAf;AAEA,MAAMC,OAAO,GAAG,uBAAhB,C,CAEA;;AACA,MAAMC,YAAY,GAAG,OAAOC,QAAP,EAAiBC,IAAjB,KAA0B;AAE3C;AACA;AACA,MAAI,CAACA,IAAI,CAACC,KAAV,EAAgB;AACZ,QAAIA,KAAK,GAAGN,OAAO,CAACO,GAAR,CAAY,OAAZ,CAAZ;;AACA,QAAID,KAAJ,EAAU;AACND,MAAAA,IAAI,CAACC,KAAL,GAAaA,KAAb;AACH;AACJ,GAT0C,CAW3C;;;AACA,QAAME,GAAG,GAAG,MAAMC,KAAK,CAACP,OAAO,GAACE,QAAT,EAAmB;AACtCM,IAAAA,MAAM,EAAC,MAD+B;AAEtCC,IAAAA,OAAO,EAAC;AACJ,gBAAU,kBADN;AAEJ,sBAAgB;AAFZ,KAF8B;AAMtCN,IAAAA,IAAI,EAACO,IAAI,CAACC,SAAL,CAAeR,IAAf;AANiC,GAAnB,CAAvB;AASA,QAAMS,IAAI,GAAG,MAAMN,GAAG,CAACM,IAAJ,EAAnB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAD,EAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;;AAEA,MAAIA,IAAI,CAACG,UAAT,EAAoB;AAChBC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,QAAvB;AACA;AACH;;AAED,SAAON,IAAP;AACH,CA/BD;;AAiCA,MAAMO,WAAW,GAAG,OAAOjB,QAAP,EAAiBC,IAAI,GAAG,EAAxB,KAA+B;AAE/C,MAAI,CAACA,IAAI,CAACC,KAAV,EAAgB;AACZ,QAAIA,KAAK,GAAGN,OAAO,CAACO,GAAR,CAAY,OAAZ,CAAZ;;AACA,QAAID,KAAJ,EAAU;AACND,MAAAA,IAAI,CAACC,KAAL,GAAaA,KAAb;AACH;AACJ;;AAED,QAAME,GAAG,GAAG,MAAMC,KAAK,CAAE,GAAEP,OAAO,GAACE,QAAS,IAAGH,EAAE,CAACY,SAAH,CAAaR,IAAb,CAAmB,EAA3C,CAAvB;AAEA,QAAMS,IAAI,GAAG,MAAMN,GAAG,CAACM,IAAJ,EAAnB;;AAEA,MAAIA,IAAI,CAACG,UAAT,EAAoB;AAChBC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,QAAvB;AACA;AACH;;AAED,SAAON,IAAP;AACH,CAnBD;;AAqBA,MAAMQ,WAAW,GAAG;AAChBC,EAAAA,KAAK,EAAE,OAAOC,KAAP,EAAcC,QAAd,KAA2B;AAC9B,UAAMC,KAAK,GAAG,MAAMvB,YAAY,CAC5B,aAD4B,EAE5B;AAACqB,MAAAA,KAAD;AAAQC,MAAAA;AAAR,KAF4B,CAAhC;AAIA,WAAOC,KAAP;AACH,GAPe;AAShBC,EAAAA,MAAM,EAAC,OAAOC,IAAP,EAAaJ,KAAb,EAAoBC,QAApB,KAAiC;AACpC,UAAMX,IAAI,GAAG,MAAMX,YAAY,CAC3B,cAD2B,EAE3B;AAAEyB,MAAAA,IAAF;AAAQJ,MAAAA,KAAR;AAAeC,MAAAA;AAAf,KAF2B,CAA/B;AAKA,WAAOX,IAAP;AACH;AAhBe,CAApB;AAoBA,gBAAe,MAAMQ,WAArB","sourcesContent":["import Cookies from \"js-cookie\";\nimport qs from 'qs';\n\nconst BASEAPI = 'http://localhost:5000';\n\n// envaindo dados para o webservice via POST\nconst apiFetchPost = async (endpoint, body) => {\n\n    // verifica se não tem um token junto no body (corpo da mensagem), neste caso ele busca\n    // nos Cookies pelo token e agrega junto no body\n    if (!body.token){\n        let token = Cookies.get('token');\n        if (token){\n            body.token = token;\n        }\n    }\n\n    // cria uma constante de comunicação com o webservice envaindo o endereço (BASEAPI) + a rota (endpoint)\n    const res = await fetch(BASEAPI+endpoint, {\n        method:'POST',\n        headers:{\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body:JSON.stringify(body)\n    });\n\n    const json = await res.json();\n    console.log(\"###########\");\n    console.log(json);\n\n    if (json.notallowed){\n        window.location.href = '/login';\n        return;\n    }\n\n    return json;\n}\n\nconst apiFetchGet = async (endpoint, body = []) => {\n\n    if (!body.token){\n        let token = Cookies.get('token');\n        if (token){\n            body.token = token;\n        }\n    }\n\n    const res = await fetch(`${BASEAPI+endpoint}?${qs.stringify(body)}`);\n\n    const json = await res.json();\n\n    if (json.notallowed){\n        window.location.href = '/login';\n        return;\n    }\n\n    return json;\n}\n\nconst AmorinhaAPI = {\n    login: async (email, password) => {\n        const jason = await apiFetchPost(\n            '/user/login',\n            {email, password}\n        );\n        return jason;\n    },\n\n    signup:async (name, email, password) => {\n        const json = await apiFetchPost(\n            '/user/signup',\n            { name, email, password }\n        );\n\n        return json\n    },\n\n};\n\nexport default () => AmorinhaAPI;"]},"metadata":{},"sourceType":"module"}